/*!
 DMXzone App Connect
 Version: 1.7.2
 (c) 2019 DMXzone.com
 @build 2019-05-03 12:29:44
 */
Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),n=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var i=arguments[1],r=0;r<n;){var s=e[r];if(t.call(i,s,r,e))return r;r++}return-1}}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),n=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var i=arguments[1],r=0;r<n;){var s=e[r];if(t.call(i,s,r,e))return s;r++}}}),Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{value:function(t){if(null==this)throw new TypeError("this is null or not defined");for(var e=Object(this),n=e.length>>>0,i=arguments[1]>>0,r=i<0?Math.max(n+i,0):Math.min(i,n),s=arguments[2],o=void 0===s?n:s>>0,a=o<0?Math.max(n+o,0):Math.min(o,n);r<a;)e[r]=t,r++;return e}}),"function"!=typeof Object.assign&&(Object.assign=function(t,e){"use strict";if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),i=1;i<arguments.length;i++){var r=arguments[i];if(null!=r)for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])}return n}),window.Element&&!Element.prototype.closest&&(Element.prototype.closest=function(t){var e,n=(this.document||this.ownerDocument).querySelectorAll(t),i=this;do{for(e=n.length;0<=--e&&n.item(e)!==i;);}while(e<0&&(i=i.parentElement));return i}),window.dmx=window.dmx||{},dmx.__components={},dmx.__attributes={before:{},mount:{},mounted:{}},dmx.__formatters={boolean:{},global:{},string:{},number:{},object:{},array:{}},dmx.__adapters={},dmx.__actions={},dmx.config={mapping:{form:"form","button, input[type=button], input[type=submit], input[type=reset]":"button","input[type=radio]":"radio","input[type=checkbox]":"checkbox","input[type=file][multiple]":"input-file-multiple","input[type=file]":"input-file",input:"input",textarea:"textarea","select[multiple]":"select-multiple",select:"select",".checkbox-group":"checkbox-group",".radio-group":"radio-group"}},dmx.reIgnoreElement=/^(script|style)$/i,dmx.rePrefixed=/^dmx-/i,dmx.reExpression=/\{\{(.+?)\}\}/,dmx.reExpressionReplace=/\{\{(.+?)\}\}/g,dmx.reToggleAttribute=/^(checked|selected|disabled|required|hidden|async|autofocus|autoplay|default|defer|multiple|muted|novalidate|open|readonly|reversed|scoped)$/i,dmx.reDashAlpha=/-([a-z])/g,dmx.reUppercase=/[A-Z]/g,dmx.appConnect=function(t,e){if(dmx.app)return alert("App already running!");t=t||document.documentElement,window.onpopstate=function(){dmx.requestUpdate()},window.onhashchange=function(){dmx.requestUpdate()};var n=dmx.Component("app");dmx.app=new n(t),dmx.app.$update(),e&&e()},document.documentElement.style.display="none",document.addEventListener("DOMContentLoaded",function(){var t=document.querySelector(':root[dmx-app], [dmx-app], :root[is="dmx-app"], [is="dmx-app"]');t?dmx.appConnect(t,function(){document.documentElement.style.display="",t.removeAttribute("dmx-app")}):(document.documentElement.style.display="",console.warn("No APP root found!"))}),dmx.useHistory=window.history&&window.history.pushState,dmx.extend=function(){var n={},i=!1,t=0,e=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(i=arguments[0],t++);for(var r=function(t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(i&&"[object Object]"===Object.prototype.toString.call(t[e])?n[e]=dmx.extend(!0,n[e],t[e]):null!=t[e]&&(n[e]=t[e]))};t<e;t++){r(arguments[t])}return n},dmx.noop=function(){},dmx.isset=function(t){return void 0!==v},dmx.clone=function(t){return t&&JSON.parse(JSON.stringify(t))},dmx.array=function(t){return null==t?[]:Array.prototype.slice.call(t)},dmx.hashCode=function(t){if(null==t)return 0;var e,n=JSON.stringify(t),i=0;for(e=0;e<n.length;e++)i=(i<<5)-i+n.charCodeAt(e),i&=i;return Math.abs(i)},dmx.randomizer=function(t){return t=+t||0,function(){return(t=(9301*t+49297)%233280)/233280}},dmx.repeatItems=function(n){var i=[];if(n){if(Array.isArray(n))i=n.map(function(t){return"object"==typeof t?dmx.clone(t):{$value:t}});else if("number"==typeof n)for(var t=0;t<n;t++)i.push({$value:t+1});else"object"==typeof n&&Object.keys(n).forEach(function(t){var e="object"==typeof n[t]?dmx.clone(n[t]):{$value:n[t]};e.$key=t,i.push(e)});i=i.map(function(t,e){return t.$key||(t.$key=e),t.$value||(t.$value=dmx.clone(t)),t.$index=e,t})}return i},dmx.escapeRegExp=function(t){return t.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")},dmx.validate=function(t){return t.checkValidity()},dmx.validateReset=function(t){},window.setImmediate?dmx.nextTick=function(t,e){return window.setImmediate(t.bind(e))}:window.postMessage?function(){var n=[];window.addEventListener("message",function(t){if(t.source===window&&"dmxNextTick"===t.data&&n.length){var e=n.shift();e.fn.call(e.context)}}),dmx.nextTick=function(t,e){n.push({fn:t,context:e}),window.postMessage("dmxNextTick","*")}}():dmx.nextTick=function(t,e){window.setTimeout(t.bind(e),0)},dmx.requestUpdate=function(){var t=!1;return function(){t||(t=!0,dmx.nextTick(function(){t=!1,dmx.app&&dmx.app.$update()}))}}(),dmx.debounce=function(e,n){var i;return function(){var t=Array.prototype.slice.call(arguments);clearTimeout(i),i=setTimeout(function(){e.apply(null,t)},n||0)}},dmx.keyCodes={bs:8,tab:9,enter:13,esc:27,space:32,left:37,up:38,right:39,down:40,delete:46,backspace:8,pause:19,capslock:20,escape:27,pageup:33,pagedown:34,end:35,home:36,arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,insert:45,numlock:144,scrolllock:145,semicolon:186,equal:187,comma:188,minus:189,period:190,slash:191,backquote:192,bracketleft:219,backslash:220,bracketright:221,quote:222,numpad0:96,numpad1:97,numpad2:98,numpad3:99,numpad4:100,numpad5:101,numpad6:102,numpad7:103,numpad8:104,numpad9:105,numpadmultiply:106,numpadadd:107,numpadsubstract:109,numpaddivide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,digit0:48,digit1:49,digit2:50,digit3:51,digit4:52,digit5:53,digit6:54,digit7:55,digit8:56,digit9:57,keya:65,keyb:66,keyc:67,keyd:68,keye:69,keyf:70,keyg:71,keyh:72,keyi:73,keyj:74,keyk:75,keyl:76,keym:77,keyn:78,keyo:79,keyp:80,keyq:81,keyr:82,keys:83,keyt:84,keyu:85,keyv:86,keyw:87,keyx:88,keyy:89,keyz:90},dmx.eventListener=function(t,e,i,r){var s,n=function(t){if((!r.self||t.target===t.currentTarget)&&(!r.ctrl||t.ctrlKey)&&(!r.alt||t.altKey)&&(!r.shift||t.shiftKey)&&(!r.meta||t.metaKey)){if((t.originalEvent||t)instanceof KeyboardEvent){var n=[];Object.keys(r).forEach(function(t){var e=parseInt(t,10);e?n.push(e):dmx.keyCodes[t]&&n.push(dmx.keyCodes[t])});for(var e=0;e<n.length;e++)if(t.which!==n[e])return}if(r.stop&&t.stopPropagation(),r.prevent&&t.preventDefault(),!r.debounce)return i.call(this,t);clearTimeout(s),s=setTimeout(i.bind(this,t),parseInt(r.debounce,10)||0)}};r=r||{},window.jQuery&&!r.capture?jQuery(t).on(e.replace(/-/g,"."),n):t.addEventListener(e,n,!!r.capture)},dmx.createClass=function(t,e){var n=function(){t.constructor&&t.constructor.apply(this,arguments)};return e&&e.prototype&&(n.prototype=Object.create(e.prototype)),Object.assign(n.prototype,t),n.prototype.constructor=n},dmx.Config=function(t){Object.assign(dmx.config,t)},dmx.Component=function(t,e){if(e){var n=dmx.Component(e.extends)||dmx.BaseComponent;e.initialData=Object.assign({},n.prototype.initialData,e.initialData),e.attributes=Object.assign({},n.prototype.attributes,e.attributes),e.methods=Object.assign({},n.prototype.methods,e.methods),e.events=Object.assign({},n.prototype.events,e.events),e.hasOwnProperty("constructor")||(e.constructor=function(t,e){n.call(this,t,e)}),e.type=t;var i=dmx.createClass(e,n);i.extends=e.extends,dmx.__components[t]=i}return dmx.__components[t]},dmx.Attribute=function(t,e,n){dmx.__attributes[e]||(dmx.__attributes[e]={}),dmx.__attributes[e][t]=n},dmx.Formatters=function(t,e){for(var n in dmx.__formatters[t]||(dmx.__formatters[t]={}),e)dmx.__formatters[t][n]=e[n]},dmx.Formatter=function(t,e,n){dmx.__formatters[t]||(dmx.__formatters[t]={}),dmx.__formatters[t][e]=n},dmx.Adapter=function(t,e,n){return dmx.__adapters[t]||(dmx.__adapters[t]={}),n&&(dmx.__adapters[t][e]=n),dmx.__adapters[t][e]},dmx.Action=function(t,e){dmx.__actions[t]=e},function(){var i=function(t){if(!(this instanceof i))return new i(t);if(t instanceof i)return t;if(!t)return this;var e=t.length;if(t.nodeType)this[0]=t,this.length=1;else{if("string"==typeof t)return i(document.querySelectorAll(t));if(e)for(var n=0;n<e;n++)t[n]&&t[n].nodeType&&(this[this.length]=t[n],this.length++)}return this};i.prototype={constructor:i,length:0,addClass:function(t){for(var e=0;e<this.length;e++)this[e].classList.add(t);return this},removeClass:function(t){for(var e=0;e<this.length;e++)this[e].classList.remove(t);return this},toggleClass:function(t){for(var e=0;e<this.length;e++)this[e].classList.toggle(t);return this},hasClass:function(t){return!!this[0]&&this[0].classList.contains(t)},attr:function(t,e){if(1===arguments.length&&"string"==typeof t)return this[0]&&this[0].getAttribute(t);for(var n=0;n<this.length;n++)if(2===arguments.length)this[n].setAttribute(t,e);else for(var i in t)this[n].setAttribute(i,t[i]);return this},removeAttr:function(t){for(var e=0;e<this.length;e++)this[e].removeAttribute(t);return this},prop:function(t,e){if(1===arguments.length&&"string"==typeof t)return this[0]&&this[0][t];for(var n=0;n<this.length;n++)if(2===arguments.length)this[n][t]=e;else for(var i in t)this[n][i]=t[i];return this},css:function(t,e){if(1===arguments.length&&"string"==typeof t)return this[0]&&window.getComputedStyle(this[0],null).getPropertyValue(t);for(var n=0;n<this.length;n++)if(2===arguments.length)this[n].style.setProperty(t,e);else for(var i in t)this[n].style.setProperty(i,t[i]);return this},each:function(t,e){if(!t)return this;for(var n=0;n<this.length;n++)if(!1===t.call(e||this[n],n,this[n]))return this;return this},append:function(){for(var t=0;t<arguments.length;t++)for(var e=i(arguments[t]),n=0;n<e.length;n++)this[0].appendChild(e[n]);return this},appendTo:function(t){return i(t).append(this),this},detach:function(){for(var t=0;t<this.length;t++)this[t].parentNode&&this[t].parentNode.removeChild(this[t]);return this},empty:function(){for(var t=0;t<this.length;t++)this[t].innerHTML="";return this}},dmx.dom={get:function(t){return i(document.getElementById(t))},select:function(t){return i(t)},create:function(t){var e=document.createElement(t);return i(e)},contains:function(t){return document.documentElement.contains(t)},walk:function(t,e,n){if(t){if(!1===e.call(n,t))return;t.hasChildNodes()&&Array.prototype.slice.call(t.childNodes,0).forEach(function(t){dmx.dom.walk(t,e,n)})}},getAttributes:function(t){var e=[];if(1==t.nodeType)for(var n=0;n<t.attributes.length;n++){var i=t.attributes[n];if(i&&i.specified&&dmx.rePrefixed.test(i.name)){var r=i.name.substr(4),s=null,o={};r.split(".").forEach(function(t,e){if(0===e)r=t;else{var n=t.indexOf(":");0<n?o[t.substr(0,n)]=t.substr(n+1):o[t]=!0}});var a=r.indexOf(":");0<a&&(s=r.substr(a+1),r=r.substr(0,a)),e.push({name:r,fullName:i.name,value:i.value,argument:s,modifiers:o})}}return e},remove:function(t){Array.isArray(t)?t.forEach(function(t){dmx.dom.remove(t)}):t.parentNode&&t.parentNode.removeChild(t)},replace:function(t,e){t.parentNode&&t.parentNode.replaceChild(e,t)}}}(),function(){var k={},w={"{":"L_CURLY","}":"R_CURLY","(":"L_PAREN",")":"R_PAREN","[":"L_BRACKET","]":"R_BRACKET",".":"PERIOD",",":"COMMA",";":"SEMI",":":"COLON","?":"QUESTION","+":"ADDICTIVE","-":"ADDICTIVE","*":"MULTIPLICATIVE","/":"MULTIPLICATIVE","%":"MULTIPLICATIVE","===":"EQUALITY","!==":"EQUALITY","==":"EQUALITY","!=":"EQUALITY","<":"RELATIONAL",">":"RELATIONAL","<=":"RELATIONAL",">=":"RELATIONAL",in:"RELATIONAL","&&":"LOGICAL_AND","||":"LOGICAL_OR","!":"LOGICAL_NOT","&":"BITWISE_AND","|":"BITWISE_OR","^":"BITWISE_XOR","~":"BITWISE_NOT","<<":"BITWISE_SHIFT",">>":"BITWISE_SHIFT",">>>":"BITWISE_SHIFT"},A={n:"\n",f:"\f",r:"\r",t:"\t",v:"\v","'":"'",'"':'"',"`":"`"},C={in:function(t,e){return t()in e()},"?":function(t,e,n){return t()?e():n()},"+":function(t,e){return t=t(),e=e(),null==t?e:null==e?t:t+e},"-":function(t,e){return t()-e()},"*":function(t,e){return t()*e()},"/":function(t,e){return t()/e()},"%":function(t,e){return t()%e()},"===":function(t,e){return t()===e()},"!==":function(t,e){return t()!==e()},"==":function(t,e){return t()==e()},"!=":function(t,e){return t()!=e()},"<":function(t,e){return t()<e()},">":function(t,e){return t()>e()},"<=":function(t,e){return t()<=e()},">=":function(t,e){return t()>=e()},"&&":function(t,e){return t()&&e()},"||":function(t,e){return t()||e()},"&":function(t,e){return t()&e()},"|":function(t,e){return t()|e()},"^":function(t,e){return t()^e()},"<<":function(t,e){return t()<<e()},">>":function(t,e){return t()>>e()},">>>":function(t,e){return t()>>>e()},"~":function(t){return~t()},"!":function(t){return!t()}},O={this:function(t){return function(){return t.data}},undefined:function(){return function(){}},null:function(){return function(){return null}},true:function(){return function(){return!0}},false:function(){return function(){return!1}}},_=function(){return 0};dmx.lexer=function(s){if(k[s])return k[s];for(var t,e,n,o,i,r,a,d,u=[],h=0,l=!0;h<s.length;){if(n=h,o=c(),'"'!=(d=o)&&"'"!=d&&"`"!=d||!l)if((m(o)||f(".")&&p()&&m(p()))&&l)e="NUMBER",t=b(),l=!1;else if(v(o)&&l)e="IDENT",t=E(),f("(")&&(e="METHOD"),l=!1;else if(f("/")&&l&&C())e="REGEXP",t=$(),l=!1;else{if(" "==(a=o)||"\r"==a||"\t"==a||"\n"==a||"\v"==a||" "==a){h++;continue}if((r=c(3))&&w[r])e=w[r],t=r,l=!0,h+=3;else if((i=c(2))&&w[i])e=w[i],t=i,l=!0,h+=2;else{if(!w[o])throw Error("Lexer Error: Unexpected token '"+o+"' at column "+h+" in expression ["+s+"]");e=w[o],t=o,l=!0,h++}}else e="STRING",t=y(o),l=!1;u.push({name:e,index:n,value:t})}return k[s]=u;function c(t){return 1<t?s.substr(h,t):s[h]}function p(t){return h+(t=t||1)<s.length&&s[h+t]}function f(t){return-1!=t.indexOf(o)}function m(t){return"0"<=t&&t<="9"}function v(t){return"a"<=t&&t<="z"||"A"<=t&&t<="Z"||"_"==t||"$"==t}function x(t){return v(t)||m(t)}function g(t){return"-"==t||"+"==t||m(t)}function y(t){var e="",n=!1;for(h++;h<s.length;){if(o=c(),n){if("u"==o){h++;var i=c(4);if(i.match(/[\da-f]{4}/i))throw Error("Invalid unicode escape");e+=String.fromCharCode(parseInt(i,16)),h+=3}else{var r=A[o];e+=r||o}n=!1}else if("\\"==o)n=!0;else{if(o==t)return h++,e;e+=o}h++}throw Error("Unterminated quote")}function b(){for(var t="",e=!1;h<s.length;){if(o=c(),f(".")&&p()&&m(p())||m(o))t+=o;else{var n=p();if(f("eE")&&g(n))t+="e",e=!0;else{if(!(g(o)&&n&&m(n)&&e)){if(!g(o)||n&&m(n)||!e)break;throw Error("Invalid exponent")}t+=o,e=!1}}h++}return+t}function E(){for(var t="";h<s.length&&x(o=c());)t+=o,h++;return t}function $(){var t="",e="",n=!1;for(h++;h<s.length;){if(o=c(),n)n=!1;else if("\\"==o)n=!0;else if("/"==o){for(h++;-1!="ign".indexOf(o=c());)e+=o,h++;return t+"%%%"+e}t+=o,h++}throw Error("Unterminated regexp")}function C(){var t=h,e=!0;try{$()}catch(t){e=!1}return h=t,o="/",e}},dmx.parse=function(e,o){if(o=o||dmx.app,dmx.reExpression.test(e))return"{{"==e.substr(0,2)&&"}}"==e.substr(-2)&&-1==e.indexOf("{{",2)?dmx.parse(e.substring(2,e.length-2),o):e.replace(dmx.reExpressionReplace,function(t,e){var n=dmx.parse(e,o);return null==n?"":n});var t;try{var a,n=dmx.lexer(e).slice(0);t=function(){var i=[];for(;;)if(0<n.length&&!(u("R_PAREN")||u("R_BRACKET")||u("R_CURLY")||u("COMMA")||u("SEMI"))&&i.push(p()),!h("COMMA")&&!h("SEMI"))return(1==i.length?i[0]:t)();function t(){for(var t,e=0;e<i.length;e++){var n=i[e];n&&(t=n())}return t}}()}catch(t){console.error(t)}return t;function d(){if(0===n.length)throw Error("Unexpected end of expression: "+e);return n[0]}function u(t){if(0<n.length){var e=n[0];if(!t||e.name==t)return e}return!1}function h(t){var e=u(t);return!!e&&(n.shift(),e)}function l(t){if(!h(t))throw Error("Unexpected token, expecting ["+t+"]. expression: "+e)}function c(t){var e=Array.prototype.slice.call(arguments,1);return function(){return C.hasOwnProperty(t)?C[t].apply(o,e):t}}function p(){return function t(){var e,n=i();{if(h("QUESTION")){if(e=t(),h("COLON"))return c("?",n,e,t());throw Error("Parse Error")}return n}}()}function i(){for(var t,e=r();;){if(!(t=h("LOGICAL_OR")))return e;e=c(t.value,e,r())}}function r(){var t,e=function(){var t,e=s();(t=h("BITWISE_OR"))&&(e=c(t.value,e,s()));return e}();return(t=h("LOGICAL_AND"))&&(e=c(t.value,e,r())),e}function s(){var t,e=f();return(t=h("BITWISE_XOR"))&&(e=c(t.value,e,f())),e}function f(){var t,e=function t(){var e,n=m();(e=h("EQUALITY"))&&(n=c(e.value,n,t()));return n}();return(t=h("BITWISE_AND"))&&(e=c(t.value,e,f())),e}function m(){var t,e=function(){var t,e=v();for(;t=h("BITWISE_SHIFT");)e=c(t.value,e,v());return e}();return(t=h("RELATIONAL"))&&(e=c(t.value,e,m())),e}function v(){for(var t,e=x();t=h("ADDICTIVE");)e=c(t.value,e,x());return e}function x(){for(var t,e=g();t=h("MULTIPLICATIVE");)e=c(t.value,e,g());return e}function g(){var t;return(t=h("ADDICTIVE"))?"+"==t.value?y():c(t.value,_,g()):(t=h("LOGICAL_NOT"))?c(t.value,g()):y()}function y(){var t,e;if(h("L_PAREN"))t=p(),l("R_PAREN");else if(h("L_CURLY")){var n={};if("R_CURLY"!=d().name)do{var i=h().value;l("COLON"),n[i]=p()()}while(h("COMMA"));t=c(n),l("R_CURLY")}else if(h("L_BRACKET")){var r=[];if("R_BRACKET"!=d().name)for(;r.push(p()()),h("COMMA"););t=c(r),l("R_BRACKET")}else if(h("PERIOD"))t=u()?$(c(o.data)):c(o.data);else{var s=h();if(!1===s)throw Error("Not a primary expression");t="IDENT"==s.name?O.hasOwnProperty(s.value)?O[s.value](o):function(){return o.get(s.value)}:"METHOD"==s.name?c(dmx.__formatters.global[s.value]||function(){window.warn&&console.warn("Formatter "+s.value+" doesn't exist")}):"REGEXP"==s.name?function(){var t=s.value.split("%%%");return new RegExp(t[0],t[1])}:function(){return s.value}}for(;e=h("L_PAREN")||h("L_BRACKET")||h("PERIOD");)if("("==e.value)t=b(t,a);else if("["==e.value)t=E(a=t);else{if("."!=e.value)throw Error("Parse Error");t=$(a=t)}return a=null,t}function b(n,i){var r=[];if("R_PAREN"!=d().name)for(;r.push(p()),h("COMMA"););return l("R_PAREN"),function(){var t=[];i&&t.push(i());for(var e=0;e<r.length;e++)t.push(r[e]());return(n()||dmx.noop).apply(o,t)}}function E(n){var i=p();return l("R_BRACKET"),function(){var t=n(),e=i();if("object"==typeof t&&null!=t)return t[e]}}function $(n){var i=h();return function(){var t=n();if("METHOD"!=i.name)return t&&t.hasOwnProperty(i.value)?t[i.value]:void 0;var e=typeof t;return"object"==e&&(e=Object.prototype.toString.call(t).slice(8,-1).toLowerCase()),"object"==e&&"function"==typeof t["__"+i.value]?t["__"+i.value]:dmx.__formatters[e]&&dmx.__formatters[e][i.value]?dmx.__formatters[e][i.value]:function(){null!=t&&console.warn&&console.warn("Formatter "+i.value+" doesn't exist for type "+e)}}}}}(),dmx.DataScope=function(t,e){return{parent:e||dmx.app,data:t,seed:Math.random(),get:function(t){return this.data.hasOwnProperty(t)?this.data[t]:this.parent?"parent"==t?this.parent.data:this.parent.get(t):void 0}}},dmx.BaseComponent=dmx.createClass({constructor:function(t,e){this.$node=t,this.parent=e,this.bindings={},this.propBindings={},this.children=[],this.listeners={},this.props={},this.data={},this.seed=Math.random(),this.name=t.getAttribute("id")||t.getAttribute("name")||this.type.toLowerCase().replace(/^dmx-/,""),this.name=this.name.replace(/[^\w]/g,""),this.dmxDomId=t.getAttribute("dmxDomId"),this.$parseAttributes(t),this.$initialData(),this.render(t),!1!==this.beforeMount(t)&&(this.$mount(t),this.$node&&(this.$customAttributes("mounted",this.$node),this.dmxDomId&&this.$node.setAttribute("dmxDomId",this.dmxDomId),(this.$node.dmxComponent=this).$node.dmxRendered=!0),this.dispatchEvent("mount"),this.mounted())},tag:null,initialData:{},attributes:{},methods:{},events:{mount:Event,destroy:Event},render:function(t){if(this.tag){if(this.tag.toUpperCase()!==this.$node.tagName){this.$node=document.createElement(this.tag);for(var e=0;e<t.attributes.length;e++){var n=t.attributes[e];n.specified&&this.$node.setAttribute(n.name,n.value)}this.$node.innerHTML=t.innerHTML}}else this.$node=null;this.$placeholder=document.createComment(" "+this.type+"["+this.name+"] "),dmx.dom.replace(t,this.$placeholder),this.$node&&this.$parse()},__find:function(t){if(this.dmxDomId==t)return this;for(var e=0;e<this.children.length;e++){var n=this.children[e].__find(t);if(n)return n}return null},__replace:function(t){var e=this.__find(t);if(e){e.$destroy();var n=document.querySelector('[dmxDomId="'+t+'"]');if(n){var i=e.parent.children.indexOf(e),r=dmx.__components[e.data.$type];if(-1<i&&r){var s=new r(n,e.parent);e.parent.children.splice(i,1,s),s.name&&e.parent.add(s.name,s.data)}}dmx.requestUpdate()}},__remove:function(t){var e=this.__find(t);if(e){e.$destroy();var n=e.parent.children.indexOf(this);-1<n&&e.parent.children.splice(n,1),dmx.requestUpdate()}},beforeMount:dmx.noop,mounted:dmx.noop,beforeUpdate:dmx.noop,update:dmx.noop,updated:dmx.noop,beforeDestroy:dmx.noop,destroyed:dmx.noop,addEventListener:function(t,e){t in this.listeners||(this.listeners[t]=[]),this.listeners[t].push(e)},removeEventListener:function(t,e){if(t in this.listeners)for(var n=this.listeners[t],i=0;i<n.length;i++)if(n[i]===e)return n.splice(i,1),this.removeEventListener(t,e)},dispatchEvent:function(e,n){if("string"==typeof e)try{e=new this.events[e](e,n)}catch(t){var i=e;if((e=document.createEvent("Event")).initEvent(i,n&&n.bubbles,n&&n.cancelable),!(e instanceof Event))return console.warn("Unknown event "+e,this.events),!1}if(!(e.type in this.listeners))return!0;var t=this.listeners[e.type];e.target=this;for(var r=0;r<t.length;r++)!1===t[r].call(this,e)&&e.preventDefault();return!e.defaultPrevented},$addChild:function(t,e){var n=new dmx.__components[t](e,this);this.children.push(n),n.name&&this.add(n.name,n.data)},$customAttributes:function(e,n){dmx.dom.getAttributes(n).forEach(function(t){dmx.__attributes[e][t.name]&&(n.removeAttribute(t.fullName),dmx.__attributes[e][t.name].call(this,n,t))},this)},$parse:function(n){(n=n||this.$node)&&(3===n.nodeType&&dmx.reExpression.test(n.nodeValue)&&this.$addBinding(n.nodeValue,function(t,e){n.nodeValue=t}),1===n.nodeType&&(dmx.config.mapping&&Object.keys(dmx.config.mapping).forEach(function(e){dmx.array(n.querySelectorAll(e)).forEach(function(t){t.hasAttribute("is")||t.setAttribute("is","dmx-"+dmx.config.mapping[e])})}),dmx.dom.walk(n,function(n){if(n!=this.$node){if(1===n.nodeType){var t=n.tagName.toLowerCase(),e=dmx.dom.getAttributes(n);if(dmx.reIgnoreElement.test(t))return!1;if(this.$customAttributes("before",n),-1!==e.findIndex(function(t){return"repeat"===t.name}))return!1;if(n.hasAttribute("is")&&(t=n.getAttribute("is")),dmx.rePrefixed.test(t))return(t=t.replace(/^dmx-/i,""))in dmx.__components?(n.isComponent=!0,n.dmxRendered||this.$addChild(t,n),!1):void console.warn("Unknown component found! "+t);this.$customAttributes("mounted",n)}3===n.nodeType&&dmx.reExpression.test(n.nodeValue)&&this.$addBinding(n.nodeValue,function(t,e){n.nodeValue=t})}},this)))},$update:function(){if(!1!==this.beforeUpdate()){var t=dmx.clone(this.props);this.$updateBindings(this.propBindings),this.$updateBindings(this.bindings),this.update(t),this.children.forEach(function(t){t.$update()}),this.updated()}},$updateBindings:function(i){Object.keys(i).forEach(function(t){var e=i[t],n=dmx.parse(t,this);JSON.stringify(n)!==JSON.stringify(e.value)&&(e.callbacks.forEach(function(t){t.call(this,n,e.value)},this),e.value=dmx.clone(n))},this)},$parseAttributes:function(s){var o=this;this.attributes&&Object.keys(this.attributes).forEach(function(t){var e=o.attributes[t],n=e.default;if(s.hasAttribute(t)&&(e.type==Boolean?n=!0:(n=s.getAttribute(t),e.type==Number&&(n=Number(n)),e.type==String&&(n=String(n)),e.validate&&!e.validate(n)&&(n=e.default)),s.removeAttribute(t)),s.hasAttribute("dmx-bind:"+t)){var i=s.getAttribute("dmx-bind:"+t),r=o.$propBinding(t).bind(o);o.propBindings[i]=o.propBindings[i]||{value:null,callbacks:[]},o.propBindings[i].callbacks.push(r),r.call(o,o.propBindings[i].value),s.removeAttribute("dmx-bind:"+t)}o.props[t]=dmx.clone(n)}),this.events&&Object.keys(this.events).forEach(function(t){s.hasAttribute("on"+t)&&(dmx.eventListener(o,t,Function("event",s.getAttribute("on"+t)),{}),s.removeAttribute("on"+t))}),dmx.dom.getAttributes(s).forEach(function(n){"on"==n.name&&this.events[n.argument]&&(dmx.eventListener(o,n.argument,function(t){var e=dmx.parse(n.value,dmx.DataScope({$event:t},o));if("string"==typeof e)try{e=new Function("event",e).call(this,t)}catch(t){console.warn('Error executing "'+e+'"',t)}return e},n.modifiers),s.removeAttribute(n.fullName))},this)},$propBinding:function(e){var n=this.attributes[e],i=this;return function(t){void 0===t&&(t=n.default),n.type==Boolean&&(t=!!t),null!=t&&(n.type==Number&&(t=Number(t)),n.type==String&&(t=String(t))),n.validate&&!n.validate(t)&&(t=n.default),i.props[e]=dmx.clone(t)}},$initialData:function(){Object.assign(this.data,{$type:this.type},"function"==typeof this.initialData?this.initialData():this.initialData),Object.keys(this.methods).forEach(function(t){var e=this;this.data["__"+t]=function(){return e.methods[t].apply(e,Array.prototype.slice.call(arguments,1))}},this)},$mount:function(t){this.$placeholder&&this.$node&&dmx.dom.replace(this.$placeholder,this.$node)},$addBinding:function(t,e){this.bindings[t]=this.bindings[t]||{value:null,callbacks:[]},this.bindings[t].callbacks.push(e),e.call(this,this.bindings[t].value)},$destroy:function(){this.dispatchEvent("destroy"),this.beforeDestroy(),this.$destroyChildren(),this.parent&&this.parent.del(this.name),this.$node&&dmx.dom.remove(this.$node),this.destroyed()},$destroyChildren:function(){this.children.forEach(function(t){t.$destroy()}),this.children=[]},get:function(t,e){return this.data.hasOwnProperty(t)?this.data[t]:this.parent&&!0!==e?"parent"==t?this.parent.data:this.parent.get(t):null},add:function(t,e){this.data[t]?Array.isArray(this.data[t])?this.data[t].push(e):this.data[t]=[this.data[t],e]:this.set(t,e),dmx.requestUpdate()},set:function(t,e){if("object"!=typeof t)JSON.stringify(this.data[t])!==JSON.stringify(e)&&(this.data[t]=e,dmx.requestUpdate());else for(var n in t)this.set(n,t[n])},del:function(t){delete this.data[t],dmx.requestUpdate()}}),function(){dmx.pathToRegexp=s,dmx.pathToRegexp.parse=i,dmx.pathToRegexp.compile=function(t,e){return n(i(t,e))},dmx.pathToRegexp.tokensToFunction=n,dmx.pathToRegexp.tokensToRegExp=r;var k="/",w=new RegExp(["(\\\\.)","(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?"].join("|"),"g");function i(t,e){for(var n,i=[],r=0,s=0,o="",a=e&&e.delimiter||k,d=e&&e.whitelist||void 0,u=!1;null!==(n=w.exec(t));){var h=n[0],l=n[1],c=n.index;if(o+=t.slice(s,c),s=c+h.length,l)o+=l[1],u=!0;else{var p="",f=n[2],m=n[3],v=n[4],x=n[5];if(!u&&o.length){var g=o.length-1,y=o[g];(!d||-1<d.indexOf(y))&&(p=y,o=o.slice(0,g))}o&&(i.push(o),o="",u=!1);var b="+"===x||"*"===x,E="?"===x||"*"===x,$=m||v,C=p||a;i.push({name:f||r++,prefix:p,delimiter:C,optional:E,repeat:b,pattern:$?O($):"[^"+A(C===a?C:C+a)+"]+?"})}}return(o||s<t.length)&&i.push(o+t.substr(s)),i}function n(u){for(var h=new Array(u.length),t=0;t<u.length;t++)"object"==typeof u[t]&&(h[t]=new RegExp("^(?:"+u[t].pattern+")$"));return function(t,e){for(var n="",i=e&&e.encode||encodeURIComponent,r=0;r<u.length;r++){var s=u[r];if("string"!=typeof s){var o,a=t?t[s.name]:void 0;if(Array.isArray(a)){if(!s.repeat)throw new TypeError('Expected "'+s.name+'" to not repeat, but got array');if(0===a.length){if(s.optional)continue;throw new TypeError('Expected "'+s.name+'" to not be empty')}for(var d=0;d<a.length;d++){if(o=i(a[d],s),!h[r].test(o))throw new TypeError('Expected all "'+s.name+'" to match "'+s.pattern+'"');n+=(0===d?s.prefix:s.delimiter)+o}}else if("string"!=typeof a&&"number"!=typeof a&&"boolean"!=typeof a){if(!s.optional)throw new TypeError('Expected "'+s.name+'" to be '+(s.repeat?"an array":"a string"))}else{if(o=i(String(a),s),!h[r].test(o))throw new TypeError('Expected "'+s.name+'" to match "'+s.pattern+'", but got "'+o+'"');n+=s.prefix+o}}else n+=s}return n}}function A(t){return t.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function O(t){return t.replace(/([=!:$/()])/g,"\\$1")}function f(t){return t&&t.sensitive?"":"i"}function r(t,e,n){for(var i=(n=n||{}).strict,r=!1!==n.start,s=!1!==n.end,o=n.delimiter||k,a=[].concat(n.endsWith||[]).map(A).concat("$").join("|"),d=r?"^":"",u=0;u<t.length;u++){var h=t[u];if("string"==typeof h)d+=A(h);else{var l=h.repeat?"(?:"+h.pattern+")(?:"+A(h.delimiter)+"(?:"+h.pattern+"))*":h.pattern;e&&e.push(h),h.optional?h.prefix?d+="(?:"+A(h.prefix)+"("+l+"))?":d+="("+l+")?":d+=A(h.prefix)+"("+l+")"}}if(s)i||(d+="(?:"+A(o)+")?"),d+="$"===a?"$":"(?="+a+")";else{var c=t[t.length-1],p="string"==typeof c?c[c.length-1]===o:void 0===c;i||(d+="(?:"+A(o)+"(?="+a+"))?"),p||(d+="(?="+A(o)+"|"+a+")")}return new RegExp(d,f(n))}function s(t,e,n){return t instanceof RegExp?function(t,e){if(!e)return t;var n=t.source.match(/\((?!\?)/g);if(n)for(var i=0;i<n.length;i++)e.push({name:i,prefix:null,delimiter:null,optional:!1,repeat:!1,pattern:null});return t}(t,e):Array.isArray(t)?function(t,e,n){for(var i=[],r=0;r<t.length;r++)i.push(s(t[r],e,n).source);return new RegExp("(?:"+i.join("|")+")",f(n))}(t,e,n):function(t,e,n){return r(i(t,n),e,n)}(t,e,n)}}(),dmx.Component("app",{constructor:function(t,e){this.onload=this.onload.bind(this),dmx.BaseComponent.call(this,t,e)},initialData:{query:{}},attributes:{},methods:{},events:{ready:Event,load:Event},render:function(t){this.parseQuery(),this.$parse(),window.removeEventListener("load",this.onload),window.addEventListener("load",this.onload),dmx.nextTick(function(){this.dispatchEvent("ready")},this)},update:function(){this.parseQuery()},onload:function(){this.dispatchEvent("load")},parseQuery:function(){var t="";window.location.search?t=window.location.search.substr(1):window.location.hash.indexOf("?")&&0<(t=window.location.hash.substr(window.location.hash.indexOf("?")+1)).indexOf("#")&&(t=t.substr(0,t.indexOf("#")));var n=t.split("&").reduce(function(t,e){var n=e.replace(/\+/g," ").split("=");return n[0]&&(t[decodeURIComponent(n[0])]=decodeURIComponent(n[1]||"")),t},{}),e=document.querySelector('meta[name="ac:base"]'),i=document.querySelector('meta[name="ac:route"]');if(i&&i.content){var r=[],s=i.content;e&&e.content&&(s=e.content.replace(/\/$/,"")+s);var o=dmx.pathToRegexp(s,r).exec(window.location.pathname);o&&r.forEach(function(t,e){n[t.name]=o[e+1]})}this.set("query",n)}}),dmx.Component("form",{tag:"form",attributes:{novalidate:{type:Boolean,default:!1}},methods:{submit:function(){this.submit()},reset:function(){this.reset()},validate:function(){this.validate()}},events:{invalid:Event,submit:Event},render:function(t){dmx.BaseComponent.prototype.render.call(this,t),this.$node.noValidate=!0,this.$node.addEventListener("submit",this.onsubmit.bind(this)),this.$node.addEventListener("reset",this.onreset.bind(this))},submit:function(t){if(this.props.novalidate||this.validate())this.dispatchEvent("submit",{cancelable:!0})&&this._submit();else{dmx.requestUpdate(),this.dispatchEvent("invalid");var e=dmx.array(this.$node.elements).find(function(t){if(!t.validity.valid)return!0});e&&e.focus()}},_submit:function(){HTMLFormElement.prototype.submit.call(this.$node)},reset:function(){HTMLFormElement.prototype.reset.call(this.$node)},validate:function(){return dmx.validate(this.$node)},onsubmit:function(t){t.preventDefault(),this.submit()},onreset:function(t){dmx.validateReset(this.$node),dmx.requestUpdate()}}),dmx.Component("form-element",{constructor:function(t,e){this.updateData=dmx.debounce(this.updateData.bind(this)),dmx.BaseComponent.call(this,t,e)},initialData:{value:"",disabled:!1,validationMessage:"",invalid:!1},attributes:{value:{type:String,default:""},disabled:{type:Boolean,default:!1}},methods:{setValue:function(t){this.setValue(t)},focus:function(){this.focus()},disable:function(t){this.disable(t)},validate:function(){this.validate()}},events:{updated:Event},render:function(t){dmx.BaseComponent.prototype.render.call(this,t),this.$node.value=this.props.value,this.$node.disabled=this.props.disabled,this.$node.defaultValue=this.props.value,this.$node.addEventListener("input",this.updateData.bind(this)),this.$node.addEventListener("change",this.updateData.bind(this)),this.$node.addEventListener("invalid",this.updateData.bind(this)),this.set("value",this.props.value),this.set("disabled",this.props.disabled)},update:function(t){JSON.stringify(t.value)!==JSON.stringify(this.props.value)&&(this.$node.defaultValue=this.props.value,this.setValue(this.props.value)),t.disabled!=this.props.disabled&&(this.$node.disabled=this.props.disabled),this.updateData()},updateData:function(t){t&&dmx.validate(this.$node),this.$node.value!==this.data.value&&dmx.nextTick(function(){this.dispatchEvent("updated")},this),this.set("value",this.$node.value),this.set("disabled",this.$node.disabled),this.$node.dirty&&(this.set("invalid",!this.$node.validity.valid),this.set("validationMessage",this.$node.validationMessage))},setValue:function(t){this.$node.value=t,this.updateData()},focus:function(){this.$node.focus()},disable:function(t){this.$node.disabled=!0===t,this.updateData()},validate:function(){dmx.validate(this.$node),this.updateData()}}),dmx.Component("textarea",{extends:"form-element",tag:"textarea",render:function(t){if(!this.props.value){var e=this.$node.value;-1!==e.indexOf("{{")?this.props.value=dmx.parse(e,this):this.props.value=e}dmx.Component("form-element").prototype.render.call(this,t)}}),dmx.Component("input",{extends:"form-element",tag:"input"}),dmx.Component("input-file",{extends:"input",initialData:{file:null},render:function(t){dmx.Component("form-element").prototype.render.call(this,t),this.$node.addEventListener("change",this.onchange.bind(this))},onchange:function(){var e=null;if(this.$node.files.length){var t=this.$node.files[0];e={date:(t.lastModified?new Date(t.lastModified):t.lastModifiedDate).toISOString(),name:t.name,size:t.size,type:t.type,dataUrl:null},-1===t.type.indexOf("image/")||t.reader||(t.reader=new FileReader,t.reader.onload=function(t){e.dataUrl=t.target.result,dmx.requestUpdate()},t.reader.readAsDataURL(t))}this.set("file",e)},setValue:function(){console.warn("Can not set value of a file input!")}}),dmx.Component("input-file-multiple",{extends:"input",initialData:{files:[]},render:function(t){dmx.Component("form-element").prototype.render.call(this,t),this.$node.addEventListener("change",this.onchange.bind(this))},onchange:function(){var t=Array.prototype.slice.call(this.$node.files).map(function(t){var e={date:(t.lastModified?new Date(t.lastModified):t.lastModifiedDate).toISOString(),name:t.name,size:t.size,type:t.type,dataUrl:null};return-1===t.type.indexOf("image/")||t.reader||(t.reader=new FileReader,t.reader.onload=function(t){e.dataUrl=t.target.result,dmx.requestUpdate()},t.reader.readAsDataURL(t)),e});this.set("files",t)},setValue:function(){console.warn("Can not set value of a file input!")}}),dmx.Component("input-number",{extends:"input",render:function(t){dmx.Component("form-element").prototype.render.call(this,t),this.set("value",+this.props.value)},updateData:function(t){t&&dmx.validate(this.$node),this.$node.value!==this.data.value&&dmx.nextTick(function(){this.dispatchEvent("updated")},this),this.set("value",this.$node.value?+this.$node.value:null),this.set("disabled",this.$node.disabled),this.$node.dirty&&(this.set("invalid",!this.$node.validity.valid),this.set("validationMessage",this.$node.validationMessage))}}),dmx.Component("button",{extends:"form-element",tag:"button",attributes:{type:{type:String,default:"button",validate:function(t){return/^(button|submit|reset)$/i.test(t)}}},render:function(t){dmx.Component("form-element").prototype.render.call(this,t),this.$node.type=this.props.type,"INPUT"===t.tagName&&(this.$node.innerText=this.props.value)}}),dmx.Component("radio",{extends:"form-element",initialData:{checked:!1},tag:"input",attributes:{checked:{type:Boolean,default:!1}},methods:{select:function(t){this.select(t)}},render:function(t){dmx.Component("form-element").prototype.render.call(this,t),this.$node.addEventListener("click",this.updateData.bind(this)),this.$node.type="radio",this.$node.checked=this.props.checked,this.set("checked",this.props.checked)},update:function(t){dmx.Component("form-element").prototype.update.call(this,t),t.checked!==this.props.checked&&(this.$node.checked=this.props.checked),this.updateData()},updateData:function(t){dmx.Component("form-element").prototype.updateData.call(this,t),this.data.checked!=this.$node.checked&&dmx.nextTick(function(){this.dispatchEvent("updated")},this),this.set("checked",this.$node.checked)},select:function(t){this.$node.checked=!1!==t}}),dmx.Component("radio-group",{initialData:{value:""},tag:"div",attributes:{value:{type:String,default:""}},methods:{setValue:function(t){this.setValue(t)}},events:{updated:Event},render:function(t){dmx.BaseComponent.prototype.render.call(this,t),this.setValue(this.props.value)},update:function(t){dmx.BaseComponent.prototype.update.call(this,t),t.value!=this.props.value&&(this.updateValue=!0,dmx.nextTick(function(){this.dispatchEvent("updated")},this))},updated:function(){this.updateValue&&(this.updateValue=!1,this.setValue(this.props.value,!0));var t=Array.prototype.slice.call(this.$node.querySelectorAll("input[type=radio]")).filter(function(t){return!t.disabled&&t.checked}).map(function(t){return t.value||1});JSON.stringify(this.data.value)!=JSON.stringify(t[0])&&(this.set("value",t[0]),dmx.nextTick(function(){this.dispatchEvent("updated")},this))},setValue:function(e,n){Array.prototype.slice.call(this.$node.querySelectorAll("input[type=radio]")).forEach(function(t){t.checked=t.value==e,n&&(t.defaultChecked=t.checked)})}}),dmx.Component("checkbox",{extends:"form-element",initialData:{checked:!1},tag:"input",attributes:{checked:{type:Boolean,default:!1}},methods:{select:function(t){this.select(t)}},render:function(t){dmx.Component("form-element").prototype.render.call(this,t),this.$node.addEventListener("click",this.updateData.bind(this)),this.$node.type="checkbox",this.$node.checked=this.props.checked,this.set("checked",this.props.checked)},update:function(t){dmx.Component("form-element").prototype.update.call(this,t),t.checked!==this.props.checked&&(this.$node.checked=this.props.checked),this.updateData()},updateData:function(t){dmx.Component("form-element").prototype.updateData.call(this,t),this.data.checked!=this.$node.checked&&dmx.nextTick(function(){this.dispatchEvent("updated")},this),this.set("checked",this.$node.checked)},select:function(t){this.$node.checked=!1!==t}}),dmx.Component("checkbox-group",{initialData:{value:[]},tag:"div",attributes:{value:{type:Array,default:[]}},methods:{setValue:function(t){this.setValue(t)}},events:{updated:Event},render:function(t){dmx.BaseComponent.prototype.render.call(this,t),this.setValue(this.props.value)},update:function(t){dmx.BaseComponent.prototype.update.call(this,t),JSON.stringify(t.value)!=JSON.stringify(this.props.value)&&(this.updateValue=!0)},updated:function(){this.updateValue&&(this.updateValue=!1,this.setValue(this.props.value));var t=Array.prototype.slice.call(this.$node.querySelectorAll("input[type=checkbox]")).filter(function(t){return!t.disabled&&t.checked}).map(function(t){return t.value||1});JSON.stringify(this.data.value)!=JSON.stringify(t)&&(this.set("value",t),dmx.nextTick(function(){this.dispatchEvent("updated")},this))},setValue:function(e,n){Array.isArray(e)||(e=[e]),Array.prototype.slice.call(this.$node.querySelectorAll("input[type=checkbox]")).forEach(function(t){t.checked=-1<e.indexOf(t.value),n&&(t.defaultChecked=t.checked)})}}),dmx.Component("select",{extends:"form-element",initialData:{selectedIndex:-1},tag:"select",attributes:{options:{type:Array,default:[]},optionText:{type:String,default:"$value"},optionValue:{type:String,default:"$value"}},methods:{setSelectedIndex:function(t){this.$node.selectedIndex=t,this.updateData()}},render:function(t){this.options=[],this.props.value?this.updateValue=!0:this.props.value=this.$node.value,dmx.BaseComponent.prototype.render.call(this,t),this.$node.disabled=this.props.disabled,this.$node.addEventListener("change",this.updateData.bind(this)),this.$node.addEventListener("invalid",this.updateData.bind(this)),this.renderOptions()},update:function(t){JSON.stringify(t.options)!==JSON.stringify(this.props.options)&&(this.renderOptions(),this.updateValue=!0),JSON.stringify(t.value)!==JSON.stringify(this.props.value)&&(this.updateValue=!0),t.disabled!=this.props.disabled&&(this.$node.disabled=this.props.disabled),this.updateData()},updated:function(){this.updateValue&&(this.updateValue=!1,this.setValue(this.props.value,!0),this.updateData())},updateData:function(t){dmx.Component("form-element").prototype.updateData.call(this,t),this.set("selectedIndex",this.$node.selectedIndex)},setValue:function(e,n){dmx.array(this.$node.options).forEach(function(t){t.selected=t.value===e,n&&(t.defaultSelected=t.selected)})},renderOptions:function(){this.options.splice(0).forEach(function(t){dmx.dom.remove(t)}),Array.isArray(this.props.options)&&this.props.options.forEach(function(t){"object"!=typeof t&&(t={$value:t});var e=document.createElement("option");e.value=dmx.parse(this.props.optionValue,dmx.DataScope(t)),e.innerText=dmx.parse(this.props.optionText,dmx.DataScope(t)),this.options.push(this.$node.appendChild(e))},this)}}),dmx.Component("select-multiple",{extends:"select",initialData:{value:[]},methods:{setSelectedIndex:function(t){this.$node.selectedIndex=t,this.updateData()}},update:function(t){JSON.stringify(t.options)!==JSON.stringify(this.props.options)&&(this.renderOptions(),this.updateValue=!0),JSON.stringify(t.value)!==JSON.stringify(this.props.value)&&(this.updateValue=!0),this.updateData()},updateData:function(){var t=Array.prototype.slice.call(this.$node.options).filter(function(t){return t.selected}).map(function(t){return t.value});JSON.stringify(t)!==JSON.stringify(this.data.value)&&dmx.nextTick(function(){this.dispatchEvent("updated")},this),this.set("value",t),this.set("disabled",this.$node.disabled),this.set("invalid",!this.$node.validity.valid),this.set("validationMessage",this.$node.validationMessage),this.set("selectedIndex",this.$node.selectedIndex)},setValue:function(e,n){Array.isArray(e)||(e=[e]),dmx.array(this.$node.options).forEach(function(t){t.selected=-1<e.indexOf(t.value),n&&(t.defaultSelected=t.selected)})}}),dmx.Component("value",{initialData:{value:null},attributes:{value:{default:null}},methods:{setValue:function(t){this.set("value",t)}},render:function(){this.set("value",this.props.value)},update:function(t){t.value!==this.props.value&&this.set("value",this.props.value)}}),dmx.Component("repeat",{initialData:{items:[]},attributes:{repeat:{type:[Array,Object,Number],default:[]},key:{type:String,default:""}},events:{update:Event,updated:Event},render:function(t){for(this.prevItems=[],this.childKeys={},this.$template=document.createDocumentFragment();this.$node.hasChildNodes();)this.$template.appendChild(this.$node.firstChild);this.update({repeat:[]})},update:function(t){if(JSON.stringify(t.repeat)!=JSON.stringify(this.props.repeat)){this.dispatchEvent("update"),t.key!==this.props.key&&this._clear();var e=dmx.Component("repeat-item"),n=this.props.repeat,i=dmx.repeatItems(n);if(i.length){if(this.props.key&&i[0].hasOwnProperty(this.props.key)&&this.prevItems.length){var r,s,o=this.props.key,a=this.prevItems,d=this._clone(i),u=0,h=0,l=a.length-1,c=d.length-1;t:for(;;){for(;a[u][o]===d[h][o];)if(this.childKeys[d[h][o]].set(d[h]),h++,l<++u||c<h)break t;for(;a[l][o]===d[c][o];)if(this.childKeys[d[c][o]].set(d[c]),c--,--l<u||c<h)break t;if(a[l][o]!==d[h][o]){if(a[u][o]!==d[c][o])break;if(s=c+1,this.childKeys[d[c][o]].set(d[c]),this._moveChild(d[c][o],d[s]&&d[s][o]),c--,l<++u||c<h)break}else if(this.childKeys[d[h][o]].set(d[h]),this._moveChild(d[h][o],a[u][o]),h++,--l<u||c<h)break}if(l<u)for(s=c+1;h<=c;)this._insertChild(d[h++],d[s]&&d[s][o]);else if(c<h)for(;u<=l;)this._removeChild(a[u++][o]);else{var p=l-u+1,f=c-h+1,m=a,v=new Array(f).fill(-1),x=!1,g=0,y=0;if(f<=4||p*f<=16){for(C=u;C<=l;C++)if(y<f)for(r=h;r<=c;r++)if(a[C][o]===d[r][o]){v[r-h]=C,r<g?x=!0:g=r,this.childKeys[d[r][o]].set(d[r]),y++,m[C]=null;break}}else{var b={};for(C=h;C<=c;C++)b[d[C][o]]=C;for(C=u;C<=l;C++)y<f&&void 0!==(r=b[a[C][o]])&&(v[r-h]=C,r<g?x=!0:g=r,this.childKeys[d[r][o]].set(d[r]),y++,m[C]=null)}if(p===a.length&&0===y)for(this._clear();h<f;)this._insertChild(d[h++],null);else{for(C=p-y;0<C;)null!==m[u]&&(this._removeChild(a[u][o]),C--),u++;if(x){var E=this._lis(v);for(r=E.length-1,C=f-1;0<=C;C--)-1===v[C]?(s=(g=C+h)+1,this._insertChild(d[g],d[s]&&d[s][o])):r<0||C!==E[r]?(s=(g=C+h)+1,this._moveChild(d[g][o],d[s]&&d[s][o])):r--}else if(y!==f)for(C=f-1;0<=C;C--)-1===v[C]&&(s=(g=C+h)+1,this._insertChild(d[g],d[s]&&d[s][o]))}}}else if(this.children.length>i.length&&this.children.splice(i.length).forEach(function(t){t.$destroy()}),this.children.length&&this.children.forEach(function(t,e){t.set(i[e])}),i.length>this.children.length){for(var $=document.createDocumentFragment(),C=this.children.length;C<i.length;C++){var k=new e(this.$template.cloneNode(!0),this,i[C]);k.$nodes.forEach(function(t){$.appendChild(t),k.$parse(t)}),this.children.push(k)}this.$node.appendChild($)}}else this._clear();this.props.key&&(this.prevItems=this._clone(i),this.children.forEach(function(t){this.childKeys[t.data[this.props.key]]=t},this)),this.set("items",i),dmx.nextTick(function(){this.dispatchEvent("updated")},this)}},_lis:function(t){var e,n,i=t.slice(0),r=[];r.push(0);for(var s=0,o=t.length;s<o;s++)if(-1!==t[s]){var a=r[r.length-1];if(t[a]<t[s])i[s]=a,r.push(s);else{for(e=0,n=r.length-1;e<n;){var d=(e+n)/2|0;t[r[d]]<t[s]?e=1+d:n=d}t[s]<t[r[e]]&&(0<e&&(i[s]=r[e-1]),r[e]=s)}}for(n=r[(e=r.length)-1];0<e--;)n=i[r[e]=n];return r},_clear:function(){this.childKeys={},this.children.splice(0).forEach(function(t){t.$destroy()})},_insertChild:function(t,e){var n=new(dmx.Component("repeat-item"))(this.$template.cloneNode(!0),this,t);n.$nodes.forEach(function(t){e?this.childKeys[e]?this.$node.insertBefore(t,this.childKeys[e].$nodes[0]):console.warn("(insert) can not insert node before key "+e+"!"):this.$node.appendChild(t),n.$parse(t)},this),this.childKeys[t[this.props.key]]=n,this.children.push(n)},_moveChild:function(t,e){var n=this.childKeys[t];n?this.childKeys[e]?n.$nodes.forEach(function(t){this.$node.insertBefore(t,this.childKeys[e].$nodes[0])},this):n.$nodes.forEach(function(t){this.$node.appendChild(t)},this):console.warn("(move) child with key "+t+" not found!")},_removeChild:function(t){var e=this.childKeys[t];e?(e.$destroy(),this.children.splice(this.children.indexOf(e),1),delete this.childKeys[t]):console.warn("(remove) child with key "+t+" not found!")},_clone:function(t){return JSON.parse(JSON.stringify(t))}}),dmx.Component("repeat-item",{constructor:function(t,e,n,i){this.parent=e,this.bindings={},this.propBindings={},this.children=[],this.listeners=[],this.props={},this.data=n||{},this.seed=e.seed,this.name=i||"repeat",this.$nodes=[];for(var r=0;r<t.childNodes.length;r++)this.$nodes.push(t.childNodes[r])},$destroy:function(){this.dispatchEvent("destroy");for(var t=0;t<this.$nodes.length;t++){var e=document.createEvent("Event");e.initEvent("remove",!1,!0),this.$nodes[t].dispatchEvent(e)&&dmx.dom.remove(this.$nodes[t])}}}),dmx.Component("fetch",{constructor:function(t,e){this.fetch=dmx.debounce(this.fetch.bind(this)),dmx.BaseComponent.call(this,t,e)},initialData:{status:0,data:null,links:{},paging:{},headers:{},state:{executing:!1,uploading:!1,processing:!1,downloading:!1},uploadProgress:{position:0,total:0,percent:0},downloadProgress:{position:0,total:0,percent:0},lastError:{status:0,message:"",response:null}},attributes:{timeout:{type:Number,default:0},method:{type:String,default:"GET"},url:{type:String,default:""},params:{type:Object,default:{}},headers:{type:Object,default:{}},data:{type:Object,default:{}},"data-type":{type:String,default:"auto"},noload:{type:Boolean,default:!1},cache:{type:String,default:""},ttl:{type:Number,default:86400}},methods:{abort:function(){this.abort()},load:function(t,e){var n={};t&&(n.params=t),e&&(n.ttl=0),this.fetch(n)}},events:{start:Event,done:Event,error:Event,invalid:Event,unauthorized:Event,forbidden:Event,abort:Event,success:Event,upload:ProgressEvent,download:ProgressEvent},$parseAttributes:function(t){dmx.BaseComponent.prototype.$parseAttributes.call(this,t),dmx.dom.getAttributes(t).forEach(function(e){"param"==e.name&&e.argument&&this.$addBinding(e.value,function(t){this.props.params[e.argument]=t}),"header"==e.name&&e.argument&&this.$addBinding(e.value,function(t){this.props.headers[e.argument]=t}),"data"==e.name&&e.argument&&this.$addBinding(e.value,function(t){this.props.data[e.argument]=t})},this)},render:function(t){this.xhr=new XMLHttpRequest,this.xhr.addEventListener("load",this.onload.bind(this)),this.xhr.addEventListener("abort",this.onabort.bind(this)),this.xhr.addEventListener("error",this.onerror.bind(this)),this.xhr.addEventListener("timeout",this.ontimeout.bind(this)),this.xhr.addEventListener("progress",this.onprogress("download").bind(this)),this.xhr.upload&&this.xhr.upload.addEventListener("progress",this.onprogress("upload").bind(this)),this.update({})},update:function(t){!this.props.noload&&this.props.url&&(t.url===this.props.url&&JSON.stringify(t.params)===JSON.stringify(this.props.params)||this.fetch())},abort:function(){this.xhr.abort()},fetch:function(e){this.xhr.abort(),e=dmx.extend(!0,this.props,e||{}),this._reset(),this.dispatchEvent("start");var t=(-1<e.url.indexOf("?")?"&":"?")+Object.keys(e.params).filter(function(t){return null!=e.params[t]},this).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e.params[t])},this).join("&");if(this._url=e.url+t,this.props.cache){var n=dmx.parse(this.props.cache+'.data["'+this._url+'"]',this);if(n){if(!(Date.now()-n.created>=1e3*e.ttl))return this.set("headers",n.headers||{}),this.set("paging",n.paging||{}),this.set("links",n.links||{}),this.set("data",n.data),this.dispatchEvent("success"),void this.dispatchEvent("done");dmx.parse(this.props.cache+'.remove("'+this._url+'")',this)}}this.set("state",{executing:!0,uploading:!1,processing:!1,downloading:!1});var i=null;"GET"!=this.props.method.toUpperCase()&&("text"==this.props["data-type"]?(e.headers["Content-Type"]||(e.headers["Content-Type"]="application/text"),i=this.props.data.toString()):"json"==this.props["data-type"]?(e.headers["Content-Type"]||(e.headers["Content-Type"]="application/json"),i=JSON.stringify(this.props.data)):"POST"==this.props.method.toUpperCase()?(i=new FormData,Object.keys(this.props.data).forEach(function(e){var t=this.props.data[e];Array.isArray(t)?(/\[\]$/.test(e)||(e+="[]"),t.forEach(function(t){i.append(e,t)},this)):i.set(e,t)},this)):(e.headers["Content-Type"]||(e.headers["Content-Type"]="application/text"),i=this.props.data.toString())),this.xhr.open(this.props.method.toUpperCase(),this._url),this.xhr.timeout=1e3*e.timeout,Object.keys(e.headers).forEach(function(t){this.xhr.setRequestHeader(t,e.headers[t])},this);try{this.xhr.send(i)}catch(t){this._done(t)}},_reset:function(){this.set({status:0,links:{},headers:{},state:{executing:!1,uploading:!1,processing:!1,downloading:!1},uploadProgress:{position:0,total:0,percent:0},downloadProgress:{position:0,total:0,percent:0},lastError:{status:0,message:"",response:null}})},_done:function(t){if(this._reset(),t)this.set("lastError",{status:0,message:t.message,response:null}),this.dispatchEvent("error");else{var e=this.xhr.responseText;try{e=JSON.parse(e)}catch(t){if(this.xhr.status<400)return this.set("lastError",{status:0,message:"Response was not valid JSON",response:e}),void this.dispatchEvent("error")}try{var n=this.xhr.getAllResponseHeaders().trim().split(/[\r\n]+/);this.set("headers",n.reduce(function(t,e){var n=e.split(": "),i=n.shift(),r=n.join(": ");return t[i]=r,t},{}))}catch(t){console.warn("Error parsing response headers",t)}try{var i=Object.keys(this.data.headers).find(function(t){return"link"==t.toLowerCase()});i&&this.set("links",this.data.headers[i].split(/,\s*</).map(function(t){try{var e=t.match(/<?([^>]*)>(.*)/),n=e[1],i=e[2].split(";"),r=n.substr(n.indexOf("?")+1);0<r.indexOf("#")&&(r=r.substr(0,r.indexOf("#")));var s=r.split("&").reduce(function(t,e){var n=e.split("=");return n[0]&&(t[decodeURIComponent(n[0])]=decodeURIComponent(n[1]||"")),t},{});i.shift();var o=i.reduce(function(t,e){var n=e.match(/\s*(.+)\s*=\s*"?([^"]+)"?/);return n&&(t[n[1]]=n[2]),t},{});return(o=Object.assign({},s,o)).url=n,o}catch(t){return console.warn("Error parsing link header part",t),null}}).filter(function(t){return t&&t.rel}).reduce(function(e,n){return n.rel.split(/\s+/).forEach(function(t){e[t]=Object.assign(n,{rel:t})}),e},{}))}catch(t){console.warn("Error parsing link header",t)}try{var r={page:1,pages:1,items:0,has:{first:!1,prev:!1,next:!1,last:!1}};if(this.data.links.prev||this.data.links.next){this.data.links.last&&this.data.links.last.page?r.pages=+this.data.links.last.page:this.data.links.prev&&this.data.prev.page&&(r.pages=+this.data.links.prev.page+1);var s=Object.keys(this.data.headers).find(function(t){return"x-total"==(t=t.toLowerCase())||"x-count"==t||"x-total-count"==t});s&&(r.items=+this.data.headers[s]),this.data.links.prev&&this.data.links.prev.page?r.page=+this.data.links.prev.page+1:this.data.links.next&&this.data.links.next.page&&(r.page=+this.data.links.next.page-1),r.has={first:!!this.data.links.first,prev:!!this.data.links.prev,next:!!this.data.links.next,last:!!this.data.links.last}}this.set("paging",r)}catch(t){console.warn("Error parsing paging",t)}this.set("status",this.xhr.status),this.xhr.status<400?(this.set("data",e),this.dispatchEvent("success"),this.props.cache&&dmx.parse(this.props.cache+'.set("'+this._url+'", { headers: headers, paging: paging, links: links, data: data, created: '+Date.now()+" })",this)):(this.set("lastError",{status:this.xhr.status,message:this.xhr.statusText,response:e}),400==this.xhr.status?this.dispatchEvent("invalid"):401==this.xhr.status?this.dispatchEvent("unauthorized"):403==this.xhr.status?this.dispatchEvent("forbidden"):this.dispatchEvent("error"))}this.dispatchEvent("done")},onload:function(t){this._done()},onabort:function(t){this._reset(),this.dispatchEvent("abort"),this.dispatchEvent("done")},onerror:function(t){this._done({message:"Failed to execute"})},ontimeout:function(t){this._done({message:"Execution timeout"})},onprogress:function(n){return function(t){t.loaded=t.loaded||t.position;var e=t.lengthComputable?Math.ceil(t.loaded/t.total*100):0;this.set("state",{executing:!0,uploading:"upload"==n&&e<100,processing:"upload"==n&&100==e,downloading:"download"==n}),this.set(n+"Progress",{position:t.loaded,total:t.total,percent:e}),this.dispatchEvent(n,{lengthComputable:t.lengthComputable,loaded:t.loaded,total:t.total})}}}),dmx.Component("serverconnect",{extends:"fetch"}),dmx.Component("serverconnect-form",{extends:"form",initialData:{status:0,data:null,headers:{},state:{executing:!1,uploading:!1,processing:!1,downloading:!1},uploadProgress:{position:0,total:0,percent:0},downloadProgress:{position:0,total:0,percent:0},lastError:{status:0,message:"",response:null}},attributes:{timeout:{type:Number,default:0},autosubmit:{type:Boolean,default:!1},params:{type:Object,default:{}},headers:{type:Object,default:{}},"post-data":{type:String,default:"form"}},methods:{abort:function(){this.abort()}},events:{start:Event,done:Event,error:Event,unauthorized:Event,forbidden:Event,abort:Event,success:Event,upload:ProgressEvent,download:ProgressEvent},$parseAttributes:function(t){dmx.BaseComponent.prototype.$parseAttributes.call(this,t),dmx.dom.getAttributes(t).forEach(function(e){"param"==e.name&&e.argument&&this.$addBinding(e.value,function(t){this.props.params[e.argument]=t}),"header"==e.name&&e.argument&&this.$addBinding(e.value,function(t){this.props.headers[e.argument]=t})},this)},render:function(t){this.xhr=new XMLHttpRequest,this.xhr.addEventListener("load",this.onload.bind(this)),this.xhr.addEventListener("abort",this.onabort.bind(this)),this.xhr.addEventListener("error",this.onerror.bind(this)),this.xhr.addEventListener("timeout",this.ontimeout.bind(this)),this.xhr.addEventListener("progress",this.onprogress("download").bind(this)),this.xhr.upload&&this.xhr.upload.addEventListener("progress",this.onprogress("upload").bind(this)),t.dmxExtraData={},dmx.Component("form").prototype.render.call(this,t),this.props.autosubmit&&dmx.nextTick(function(){this.submit()},this)},abort:function(){this.xhr.abort()},_submit:function(n){this.xhr.abort();var t=this.$node.method.toUpperCase(),e=this.$node.action,i=null,r=Object.keys(this.props.params).filter(function(t){return null!=this.props.params[t]},this).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(this.props.params[t])},this).join("&");"GET"==t?(r+=dmx.array(this.$node.elements).filter(function(t){return!(n&&n[t.name])&&!t.disabled&&("radio"!==t.type&&"checkbox"!==t.type||t.checked)}).map(function(t){return encodeURIComponent(t.name)+"="+encodeURIComponent(t.value)}).join("&"),n&&Object.keys(n).forEach(function(e){Array.isArray(n[e])?n[e].forEach(function(t){r+="&"+encodeURIComponent(e)+"="+encodeURIComponent(t)}):r+="&"+encodeURIComponent(e)+"="+encodeURIComponent(n[e])})):"json"==this.props["post-data"]?(i={},dmx.array(this.$node.elements).forEach(function(t){if(t.name&&!t.disabled)if("radio"==t.type.toLowerCase){var e=document.querySelector('input[name="'+t.name+'"]:checked');e&&(i[t.name]=e.value)}else if("checkbox"==t.type){var n=document.querySelectorAll('input[name="'+t.name+'"]');n.length&&(1==n.length?i[t.name]=n[0].checked:i[t.name]=dmx.array(n).filter(function(t){return t.checked}).map(function(t){return checkbox.value}))}else"select-multiple"==t.type?i[t.name]=dmx.array(t.selectedOptions).map(function(t){return t.value}):"file"==t.type?t.files.length&&(t.multiple?i[t.name]=t.files.map(function(t){return t.name}):i[t.name]=t.files[0].name):i[t.name]=t.value}),n&&Object.assign(i,n),this.$node.dmxExtraData&&Object.assign(i,this.$node.dmxExtraData),this.props.headers["Content-Type"]="application/json",i=JSON.stringify(i)):(i=new FormData(this.$node),n&&Object.keys(n).forEach(function(e){Array.isArray(n[e])?(/\[\]$/.test(e)||(e+="[]"),value.forEach(function(t){i.append(e,t)},this)):i.set(e,n[e])},this),this.$node.dmxExtraData&&Object.keys(this.$node.dmxExtraData).forEach(function(e){var t=this.$node.dmxExtraData[e];Array.isArray(t)?(/\[\]$/.test(e)||(e+="[]"),t.forEach(function(t){i.append(e,t)},this)):i.set(e,t)},this)),this._reset(),this.dispatchEvent("start"),this.xhr.open(t,e+(r?(-1<e.indexOf("?")?"&":"?")+r:"")),this.xhr.timeout=1e3*this.props.timeout,Object.keys(this.props.headers).forEach(function(t){this.xhr.setRequestHeader(t,this.props.headers[t])},this);try{this.xhr.send(i)}catch(t){this._done(t)}},_reset:function(){this.set({status:0,headers:{},state:{executing:!1,uploading:!1,processing:!1,downloading:!1},uploadProgress:{position:0,total:0,percent:0},downloadProgress:{position:0,total:0,percent:0},lastError:{status:0,message:"",response:null}})},_done:function(t){if(this._reset(),t)this.set("lastError",{status:0,message:t.message,response:null}),this.dispatchEvent("error");else{var e=this.xhr.responseText;try{e=JSON.parse(e)}catch(t){if(this.xhr.status<400)return this.set("lastError",{status:0,message:"Response was not valid JSON",response:e}),void this.dispatchEvent("error")}try{var n=this.xhr.getAllResponseHeaders().trim().split(/[\r\n]+/);this.set("headers",n.reduce(function(t,e){var n=e.split(": "),i=n.shift(),r=n.join(": ");return t[i]=r,t},{}))}catch(t){console.warn("Error parsing response headers",t)}if(this.set("status",this.xhr.status),this.xhr.status<400)this.set("data",e),this.dispatchEvent("success");else if(this.set("lastError",{status:this.xhr.status,message:this.xhr.statusText,response:e}),400==this.xhr.status)if(this.dispatchEvent("invalid"),-1<this.$node.action.indexOf("dmxConnect/")&&e.form)for(var i in e.form){var r=document.querySelector('[name="'+i+'"]');r&&(r.setCustomValidity(e.form[i]),dmx.requestUpdate(),dmx.bootstrap3forms?dmx.validate.setBootstrapMessage(r,e.form[i]):dmx.validate.setErrorMessage(r,e.form[i]))}else console.warn("400 error, no form errors in response.",e);else 401==this.xhr.status?this.dispatchEvent("unauthorized"):403==this.xhr.status?this.dispatchEvent("forbidden"):this.dispatchEvent("error")}this.dispatchEvent("done")},onload:function(t){this._done()},onabort:function(t){this._reset(),this.dispatchEvent("abort"),this.dispatchEvent("done")},onerror:function(t){this._done({message:"Failed to execute"})},ontimeout:function(t){this._done({message:"Execution timeout"})},onprogress:function(n){return function(t){t.loaded=t.loaded||t.position;var e=t.lengthComputable?Math.ceil(t.loaded/t.total*100):0;this.set("state",{executing:!0,uploading:"upload"==n&&e<100,processing:"upload"==n&&100==e,downloading:"download"==n}),this.set(n+"Progress",{position:t.loaded,total:t.total,percent:e}),this.dispatchEvent(n,{lengthComputable:t.lengthComputable,loaded:t.loaded,total:t.total})}}}),dmx.Component("if",{attributes:{condition:{type:Boolean,default:!1}},render:function(t){for(this.nodes=[],this.template=document.createDocumentFragment();this.$node.firstChild;)this.template.appendChild(this.$node.firstChild);this.update({})},update:function(t){this.props.condition!=t.condition&&(this.props.condition?this._render():this._destroy())},_render:function(){var t=this.template.cloneNode(!0);this.nodes=Array.prototype.slice.call(t.childNodes),this.$node.appendChild(t),this.$parse()},_destroy:function(){this.bindings={},this.nodes.splice(0).forEach(function(t){var e=document.createEvent("Event");e.initEvent("remove",!1,!0),t.dispatchEvent(e)&&dmx.dom.remove(t)}),this.children.splice(0).forEach(function(t){t.$destroy()})}}),dmx.Component("datetime",{initialData:function(){return{datetime:this.datetime()}},attributes:{interval:{type:String,default:"seconds"},utc:{type:Boolean,default:!1}},render:function(){this.timer()},timer:function(){this.set("datetime",this.datetime()),requestAnimationFrame(this.timer.bind(this))},datetime:function(){var t,e,n,i,r,s,o=new Date,a=function(t,e){return("0000"+t).substr(-e)};s=this.props.utc?(t=o.getUTCFullYear(),e=o.getUTCMonth()+1,n=o.getUTCDate(),i=o.getUTCHours(),r=o.getUTCMinutes(),o.getUTCSeconds()):(t=o.getFullYear(),e=o.getMonth()+1,n=o.getDate(),i=o.getHours(),r=o.getMinutes(),o.getSeconds());var d=a(t,4)+"-"+a(e,2)+"-"+a(n,2),u=this.props.utc?"Z":"";switch(this.props.interval){case"days":return d+"T00:00:00"+u;case"hours":return d+"T"+a(i,2)+":00:00"+u;case"minutes":return d+"T"+a(i,2)+":"+a(r,2)+":00"+u}return d+"T"+a(i,2)+":"+a(r,2)+":"+a(s,2)+u}}),dmx.Component("api-action",{extends:"fetch"}),dmx.Component("api-form",{extends:"serverconnect-form"}),dmx.Component("array",{initialData:{items:[],count:0},attributes:{items:{type:Array,default:[]}},events:{updated:Event},methods:{add:function(t){this.splice(this.count(),0,t)},addUniq:function(t){-1==this.indexOf(t)&&this.splice(this.count(),0,t)},insert:function(t,e){this.splice(t,0,e)},insertBefore:function(t,e){var n=this.indexOf(t);-1!=n&&this.splice(n,0,e)},insertAfter:function(t,e){var n=this.indexOf(t);-1!=n&&this.splice(n+1,0,e)},replace:function(t,e){var n=this.indexOf(t);-1!=n&&this.splice(n,1,e)},replaceAt:function(t,e){this.splice(t,1,e)},remove:function(t){var e=this.indexOf(t);-1!=e&&this.splice(e,1)},removeAt:function(t){this.splice(t,1)},reverse:function(){this.reverse()},sort:function(){this.sort()}},render:function(){var t=dmx.array(this.props.items);this.set("items",t),this.set("count",t.length)},update:function(t){JSON.stringify(t.items)!=JSON.stringify(this.props.items)&&this.updateData(dmx.array(this.props.items))},count:function(){return this.data.items.length},indexOf:function(t){return this.data.items.indexOf(t)},splice:function(t,e,n){var i=dmx.clone(this.data.items);void 0!==n?i.splice(t,e,n):i.splice(t,e),this.updateData(i)},reverse:function(){var t=dmx.clone(this.data.items);t.reverse(),this.updateData(t)},sort:function(){var t=dmx.clone(this.data.items);t.sort(),this.updateData(t)},updateData:function(t){JSON.stringify(this.data.items)!=JSON.stringify(t)&&(this.set("items",t),this.set("count",t.length),dmx.nextTick(function(){this.dispatchEvent("updated")},this))}}),dmx.Attribute("bind","mounted",function(n,t){var i=t.argument,r=dmx.reToggleAttribute.test(i);this.$addBinding(t.value,function(t){if(r)t?n.setAttribute(i,""):n.removeAttribute(i);else{if("style"===i&&"object"==typeof t){for(var e in t)n.style[e]=t[e];return}null!=t?n.setAttribute(i,t):n.removeAttribute(i),"src"===i&&("VIDEO"===n.nodeName||"AUDIO"===n.nodeName?n.load():"SOURCE"===n.nodeName&&n.parentNode&&n.parentNode.load())}})}),dmx.Attribute("on","mounted",function(t,n){var i=this;dmx.eventListener(t,n.argument,function(t){var e=dmx.parse(n.value,dmx.DataScope({$event:t},i));if("string"==typeof e)try{e=new Function("event",e).call(this,t)}catch(t){console.warn('Error executing "'+e+'"',t)}return e},n.modifiers)}),dmx.Attribute("repeat","before",function(t,o){if(this.node!=t){var a=this,d=[],u=document.createDocumentFragment(),h=document.createComment("Repeat "+o.value);dmx.Component("repeat-item");t.parentNode.replaceChild(h,t),t.removeAttribute("dmx-repeat"),u.appendChild(t),this.add(o.argument||"repeat",[]),this.$addBinding(o.value,function(t){var e=dmx.Component("repeat-item"),n=dmx.repeatItems(t);if(o.modifiers.fast){if(d.length>n.length&&d.splice(n.length).forEach(function(t){a.children.splice(a.children.indexOf(t),1),t.$destroy()}),d.length&&d.forEach(function(t,e){t.set(n[e])}),n.length>d.length){for(i=document.createDocumentFragment(),r=d.length;r<n.length;r++){(s=new e(u.cloneNode(!0),a,n[r])).$nodes.forEach(function(t){i.appendChild(t),s.$parse(t)}),d.push(s),a.children.push(s)}h.parentNode.insertBefore(i,h)}}else{var i=document.createDocumentFragment();d.forEach(function(t){a.children.splice(a.children.indexOf(t),1),t.$destroy()}),d=[];for(var r=0;r<n.length;r++){var s;(s=new e(u.cloneNode(!0),a,n[r])).$nodes.forEach(function(t){i.appendChild(t),s.$parse(t)}),d.push(s),a.children.push(s)}h.parentNode.insertBefore(i,h)}})}}),dmx.Attribute("class","mounted",function(n,t){var i=t.argument;this.$addBinding(t.value,function(t,e){n.classList[t?"add":"remove"](i)})}),dmx.Attribute("hide","mounted",function(e,t){var n=e.style.display;this.$addBinding(t.value,function(t){e.style.display=t?"none":n})}),dmx.Attribute("show","mounted",function(e,t){var n=e.style.display;this.$addBinding(t.value,function(t){e.style.display=t?n:"none"})}),dmx.Attribute("html","mounted",function(e,t){this.$addBinding(t.value,function(t){null!=t&&(e.innerHTML=t)})}),dmx.Attribute("text","mounted",function(e,t){this.$addBinding(t.value,function(t){null!=t&&(e.innerText=t)})}),dmx.Attribute("style","mounted",function(e,t){var n=t.argument,i=t.modifiers.important?"important":"";this.$addBinding(t.value,function(t){null!=t&&e.style.setProperty(n,t,i)})}),dmx.Formatters("global",{json:function(t){return JSON.stringify(t)},log:function(t){return console.log(t),t}});
//# sourceMappingURL=maps/dmxAppConnect.js.map
